"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{62741:function(e,a,s){s.d(a,{m:function(){return L}});var t=s(57437),r=s(2265),l=s(10795),n=s(59892),i=s(79820),o=s(69174),d=s(41905),c=s(13041),m=s(83774),x=s(1072),u=s(14438),h=s(57586),p=s(98239),f=s(32489),j=s(99397),g=s(89345),N=s(98420),v=s(62720),w=s(31047),b=s(65621),y=s(44743),C=s(65698),_=s(12381),Z=s(31593),S=s(40279),k=s(23675),E=s(17168),F=s(21191);function I(e){let{lead:a,open:s,onClose:l,onUpdate:n}=e,[i,d]=(0,r.useState)(!1),[I,z]=(0,r.useState)(""),[R,P]=(0,r.useState)(""),{notes:A,interactions:L,tags:D,isLoading:O,addNote:B,addTag:V,removeTag:Q}=function(e){let[a,s]=(0,r.useState)([]),[t,l]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[o,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&c()},[e]);let c=async()=>{if(e){d(!0);try{let{data:a}=await x.O.from("lead_notes").select("*").eq("lead_id",e).order("created_at",{ascending:!1});a&&s(a);let{data:t}=await x.O.from("lead_interactions").select("*").eq("lead_id",e).order("created_at",{ascending:!1});t&&l(t);let{data:r}=await x.O.from("leads_prospeccao").select("tags").eq("id",e).single();r&&i(r.tags||[])}catch(e){console.error("Error loading details:",e),u.Am.error("Erro ao carregar detalhes do lead")}finally{d(!1)}}},m=async a=>{if(!e)return;let s=[...n,a];try{let{error:a}=await x.O.from("leads_prospeccao").update({tags:s}).eq("id",e);if(a)throw a;i(s),u.Am.success("Tag adicionada!")}catch(e){console.error("Error adding tag:",e),u.Am.error("Erro ao adicionar tag")}},h=async a=>{if(!e)return;let s=n.filter(e=>e!==a);try{let{error:a}=await x.O.from("leads_prospeccao").update({tags:s}).eq("id",e);if(a)throw a;i(s),u.Am.success("Tag removida!")}catch(e){console.error("Error removing tag:",e),u.Am.error("Erro ao remover tag")}},p=async function(a,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e)try{await x.O.from("lead_interactions").insert([{lead_id:e,type:a,description:s,metadata:t}])}catch(e){console.error("Error logging interaction:",e)}};return{notes:a,interactions:t,tags:n,isLoading:o,addNote:async a=>{if(e)try{let{error:s}=await x.O.from("lead_notes").insert([{lead_id:e,content:a}]);if(s)throw s;await p("note_added","Adicionou uma anota\xe7\xe3o"),u.Am.success("Nota adicionada!"),c()}catch(e){console.error("Error adding note:",e),u.Am.error("Erro ao adicionar nota")}},addTag:m,removeTag:h,refresh:c}}(null==a?void 0:a.id);if(!a)return null;let q=async()=>{I.trim()&&(await B(I),z(""))},T=async e=>{"Enter"===e.key&&R.trim()&&(await V(R.trim()),P(""))};return(0,t.jsx)(h.M,{children:s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.E.div,{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50",initial:{opacity:0},animate:{opacity:1,transition:{duration:.18}},exit:{opacity:0,transition:{duration:.16}},onClick:l}),(0,t.jsxs)(p.E.div,{className:"fixed right-0 top-0 bottom-0 w-full max-w-md bg-card border-l shadow-elevated z-50 flex flex-col",initial:{x:320,opacity:0},animate:{x:0,opacity:1,transition:{duration:.26,ease:"easeOut"}},exit:{x:320,opacity:0,transition:{duration:.2,ease:"easeIn"}},children:[(0,t.jsxs)("div",{className:"flex-none bg-card border-b px-6 py-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:a.lead}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:a.empresa||"Empresa n\xe3o informada"})]}),(0,t.jsx)(_.z,{variant:"ghost",size:"icon",onClick:l,className:"rounded-full",children:(0,t.jsx)(f.Z,{className:"h-5 w-5"})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,t.jsxs)(E.mQ,{defaultValue:"details",className:"w-full h-full flex flex-col",children:[(0,t.jsx)("div",{className:"px-6 pt-4",children:(0,t.jsxs)(E.dr,{className:"w-full grid grid-cols-3",children:[(0,t.jsx)(E.SP,{value:"details",children:"Detalhes"}),(0,t.jsx)(E.SP,{value:"history",children:"Hist\xf3rico"}),(0,t.jsx)(E.SP,{value:"notes",children:"Anota\xe7\xf5es"})]})}),(0,t.jsxs)(E.nU,{value:"details",className:"flex-1 p-6 space-y-6 outline-none",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.C,{variant:"outline",className:"bg-primary/10 text-primary border-primary/20",children:a.status}),(0,t.jsx)(o.C,{variant:"outline",className:"bg-accent/10 text-accent border-accent/20",children:a.origem})]}),(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[D.map((e,a)=>(0,t.jsxs)(o.C,{variant:"secondary",className:"flex items-center gap-1",children:[e,(0,t.jsx)(f.Z,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>Q(e)})]},a)),(0,t.jsxs)("div",{className:"relative flex items-center",children:[(0,t.jsx)(j.Z,{className:"absolute left-2 h-3 w-3 text-muted-foreground"}),(0,t.jsx)(S.I,{className:"h-6 w-24 pl-6 text-xs",placeholder:"Nova tag...",value:R,onChange:e=>P(e.target.value),onKeyDown:T})]})]})}),(0,t.jsx)(Z.Z,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 text-primary"}),"Informa\xe7\xf5es de Contato"]}),a.whatsapp&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"WhatsApp"}),(0,t.jsx)("a",{href:"https://wa.me/".concat(a.whatsapp.replace(/\D/g,"")),target:"_blank",rel:"noopener noreferrer",className:"text-foreground hover:text-primary transition-smooth",children:a.whatsapp})]})]}),a.contatoPrincipal&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Contato Principal"}),(0,t.jsx)("p",{className:"text-foreground",children:a.contatoPrincipal})]})]}),a.regiao&&(0,t.jsxs)("div",{className:"flex items-start gap-3 text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Regi\xe3o"}),(0,t.jsx)("p",{className:"text-foreground",children:a.regiao})]})]})]}),(0,t.jsx)(Z.Z,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-foreground flex items-center gap-2",children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 text-primary"}),"Informa\xe7\xf5es do Neg\xf3cio"]}),a.segmento&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Segmento"}),(0,t.jsx)("p",{className:"text-foreground",children:a.segmento})]})]}),a.prioridade&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Prioridade"}),(0,t.jsx)("p",{className:"text-foreground",children:a.prioridade})]})]}),a.ticketMedioEstimado&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Ticket M\xe9dio Estimado"}),(0,t.jsx)("p",{className:"text-foreground font-medium",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(a.ticketMedioEstimado)||0)})]})]}),a.dataContato&&(0,t.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Data do Contato"}),(0,t.jsx)("p",{className:"text-foreground",children:new Date(a.dataContato).toLocaleDateString("pt-BR")})]})]})]})]}),(0,t.jsx)(E.nU,{value:"history",className:"flex-1 p-6 space-y-6 outline-none",children:(0,t.jsx)("div",{className:"space-y-6",children:0===L.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"Nenhuma intera\xe7\xe3o registrada"}):L.map(e=>(0,t.jsxs)("div",{className:"flex gap-4 relative pb-6 last:pb-0",children:[(0,t.jsx)("div",{className:"absolute left-[19px] top-8 bottom-0 w-px bg-border last:hidden"}),(0,t.jsx)("div",{className:"relative z-10 h-10 w-10 shrink-0 rounded-full bg-muted flex items-center justify-center border",children:"status_change"===e.type?(0,t.jsx)(b.Z,{className:"h-4 w-4"}):"whatsapp_sent"===e.type?(0,t.jsx)(y.Z,{className:"h-4 w-4"}):"note_added"===e.type?(0,t.jsx)(C.Z,{className:"h-4 w-4"}):(0,t.jsx)(w.Z,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex-1 pt-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.description}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleString("pt-BR")})]})]},e.id))})}),(0,t.jsx)(E.nU,{value:"notes",className:"flex-1 p-6 space-y-6 outline-none",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k.g,{placeholder:"Adicionar uma anota\xe7\xe3o...",value:I,onChange:e=>z(e.target.value),className:"min-h-[100px]"}),(0,t.jsx)(_.z,{onClick:q,disabled:!I.trim(),className:"w-full",children:"Adicionar Nota"})]}),(0,t.jsx)(Z.Z,{}),(0,t.jsx)("div",{className:"space-y-4",children:0===A.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground py-8",children:"Nenhuma anota\xe7\xe3o encontrada"}):A.map(e=>(0,t.jsxs)("div",{className:"bg-muted/30 p-4 rounded-lg space-y-2",children:[(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground text-right",children:new Date(e.created_at).toLocaleString("pt-BR")})]},e.id))})]})})]})}),(0,t.jsxs)("div",{className:"flex-none bg-card border-t px-6 py-4 flex gap-2",children:[(0,t.jsx)(_.z,{className:"flex-1",variant:"outline",onClick:l,children:"Fechar"}),(0,t.jsx)(_.z,{className:"flex-1 gradient-primary text-white",onClick:()=>d(!0),children:"Editar Lead"})]})]}),(0,t.jsx)(F.t,{lead:a,open:i,onClose:()=>d(!1),onSuccess:()=>{d(!1),n&&n()}})]})})}let z=["Novo Lead","Contato Inicial","Proposta Enviada","Negocia\xe7\xe3o","Fechado","Follow-up"],R={"Novo Lead":"bg-blue-500","Contato Inicial":"bg-purple-500","Proposta Enviada":"bg-orange-500",Negociação:"bg-indigo-500",Fechado:"bg-green-500","Follow-up":"bg-pink-500",Qualificação:"bg-yellow-500","Fechado Ganho":"bg-green-500","Fechado Perdido":"bg-red-500","Em Follow-up":"bg-pink-500"};function P(e){let{lead:a,onClick:s}=e,{attributes:r,listeners:x,setNodeRef:u,transform:h,isDragging:p}=(0,l.O1)({id:a.id,data:{lead:a}}),f={transform:n.ux.Translate.toString(h),opacity:p?0:1,visibility:p?"hidden":"visible"};return(0,t.jsx)("div",{ref:u,style:f,...r,...x,children:(0,t.jsx)(i.Zb,{className:"p-3 mb-2 cursor-grab active:cursor-grabbing hover:shadow-md transition-shadow overflow-hidden bg-card",onClick:s,children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"cursor-grab pt-1 flex-shrink-0",children:(0,t.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-semibold text-sm truncate",children:a.lead}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.empresa})]}),a.categoria&&(0,t.jsx)(o.C,{variant:"outline",className:"text-[10px] px-1.5 py-0 shrink-0 max-w-[100px]",children:(0,t.jsx)("span",{className:"truncate",children:a.categoria})})]}),(0,t.jsxs)("div",{className:"space-y-1 text-xs text-muted-foreground",children:[a.whatsapp&&(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[(0,t.jsx)(c.Z,{className:"h-3 w-3 shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:a.whatsapp})]}),a.cidade&&(0,t.jsxs)("div",{className:"flex items-center gap-1 min-w-0",children:[(0,t.jsx)(m.Z,{className:"h-3 w-3 shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:a.cidade})]})]})]})]})})})}function A(e){let{status:a,leads:s,onCardClick:r}=e,{setNodeRef:n,isOver:i}=(0,l.Zj)({id:a});return(0,t.jsxs)("div",{ref:n,className:"flex-shrink-0 w-80 bg-muted/30 rounded-lg p-4 transition-colors h-full flex flex-col ".concat(i?"bg-muted/50 ring-2 ring-primary/50":""),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(R[a])}),(0,t.jsx)("h3",{className:"font-semibold text-sm",children:a})]}),(0,t.jsx)(o.C,{variant:"secondary",className:"text-xs",children:s.length})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto min-h-[100px] pr-1 custom-scrollbar",children:[s.map(e=>(0,t.jsx)(P,{lead:e,onClick:()=>r(e)},e.id)),0===s.length&&(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-muted rounded-lg",children:"Arraste leads para c\xe1"})]})]})}function L(e){let{leads:a,onLeadUpdate:s}=e,[n,o]=(0,r.useState)(null),[c,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),f=(0,l.Dy)((0,l.VT)(l.we,{activationConstraint:{distance:8}})),j=async e=>{let{active:t,over:r}=e;if(o(null),!r)return;let l=t.id,n=r.id;if(!z.includes(n))return;let i=a.find(e=>e.id===l);if(i&&i.status!==n)try{let e={estagio_pipeline:n,updated_at:new Date().toISOString()},{error:a}=await x.O.from("leads_prospeccao").update(e).eq("id",l);if(a)throw a;u.Am.success("Lead movido para ".concat(n)),s()}catch(e){console.error("Error updating lead:",e),u.Am.error("Erro ao atualizar lead")}},g=e=>{m(e),p(!0)},N=z.reduce((e,s)=>(e[s]=a.filter(e=>e.status===s),e),{}),v=n?a.find(e=>e.id===n):null;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l.LB,{sensors:f,collisionDetection:l.ey,onDragStart:e=>{o(e.active.id)},onDragEnd:j,children:[(0,t.jsx)("div",{className:"overflow-x-auto pb-4 h-[calc(100vh-250px)]",children:(0,t.jsx)("div",{className:"flex gap-4 min-w-max h-full",children:z.map(e=>(0,t.jsx)(A,{status:e,leads:N[e],onCardClick:g},e))})}),(0,t.jsx)(l.y9,{children:v?(0,t.jsx)(i.Zb,{className:"p-3 shadow-lg rotate-3 opacity-90 w-72 cursor-grabbing",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-semibold text-sm",children:v.lead}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:v.empresa})]})]})}):null})]}),(0,t.jsx)(I,{lead:c,open:h,onClose:()=>{p(!1),m(null)},onUpdate:()=>{s()}})]})}},21191:function(e,a,s){s.d(a,{t:function(){return E}});var t=s(57437),r=s(29501),l=s(13590),n=s(67119),i=s(74291),o=s(2265),d=s(37053),c=s(93448),m=s(75060);let x=r.RV,u=o.createContext({}),h=e=>{let{...a}=e;return(0,t.jsx)(u.Provider,{value:{name:a.name},children:(0,t.jsx)(r.Qr,{...a})})},p=()=>{let e=o.useContext(u),a=o.useContext(f),{getFieldState:s,formState:t}=(0,r.Gc)(),l=s(e.name,t);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=a;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...l}},f=o.createContext({}),j=o.forwardRef((e,a)=>{let{className:s,...r}=e,l=o.useId();return(0,t.jsx)(f.Provider,{value:{id:l},children:(0,t.jsx)("div",{ref:a,className:(0,c.cn)("space-y-2",s),...r})})});j.displayName="FormItem";let g=o.forwardRef((e,a)=>{let{className:s,...r}=e,{error:l,formItemId:n}=p();return(0,t.jsx)(m._,{ref:a,className:(0,c.cn)(l&&"text-destructive",s),htmlFor:n,...r})});g.displayName="FormLabel";let N=o.forwardRef((e,a)=>{let{...s}=e,{error:r,formItemId:l,formDescriptionId:n,formMessageId:i}=p();return(0,t.jsx)(d.g7,{ref:a,id:l,"aria-describedby":r?"".concat(n," ").concat(i):"".concat(n),"aria-invalid":!!r,...s})});N.displayName="FormControl",o.forwardRef((e,a)=>{let{className:s,...r}=e,{formDescriptionId:l}=p();return(0,t.jsx)("p",{ref:a,id:l,className:(0,c.cn)("text-sm text-muted-foreground",s),...r})}).displayName="FormDescription";let v=o.forwardRef((e,a)=>{let{className:s,children:r,...l}=e,{error:n,formMessageId:i}=p(),o=n?String(null==n?void 0:n.message):r;return o?(0,t.jsx)("p",{ref:a,id:i,className:(0,c.cn)("text-sm font-medium text-destructive",s),...l,children:o}):null});v.displayName="FormMessage";var w=s(15291),b=s(40279),y=s(23675),C=s(12381),_=s(51817),Z=s(14438),S=s(1072);let k=n.Ry({empresa:n.Z_().min(1,"Nome da empresa \xe9 obrigat\xf3rio"),status:n.Km(["Novo Lead","Contato Inicial","Qualifica\xe7\xe3o","Proposta Enviada","Negocia\xe7\xe3o","Fechado Ganho","Fechado Perdido","Em Follow-up","Fechado","Follow-up"]),contato:n.Z_().optional(),whatsapp:n.Z_().optional(),email:n.Z_().email("Email inv\xe1lido").optional().or(n.i0("")),website:n.Z_().url("URL inv\xe1lida").optional().or(n.i0("")),instagram:n.Z_().optional(),cidade:n.Z_().optional(),endereco:n.Z_().optional(),categoria:n.Z_().optional(),cnpj:n.Z_().optional(),aceitaCartao:n.Z_().optional()});function E(e){let{lead:a,open:s,onClose:n,onSuccess:o}=e,d=(0,r.cI)({resolver:(0,l.F)(k),defaultValues:{empresa:(null==a?void 0:a.empresa)||"",status:(null==a?void 0:a.status)||"Novo Lead",contato:(null==a?void 0:a.contato)||"",whatsapp:(null==a?void 0:a.whatsapp)||"",email:(null==a?void 0:a.email)||"",website:(null==a?void 0:a.website)||"",instagram:(null==a?void 0:a.instagram)||"",cidade:(null==a?void 0:a.cidade)||"",endereco:(null==a?void 0:a.endereco)||"",categoria:(null==a?void 0:a.categoria)||"",cnpj:(null==a?void 0:a.cnpj)||"",aceitaCartao:(null==a?void 0:a.aceitaCartao)||""}});a&&s&&d.reset({empresa:a.empresa||"",status:a.status||"Novo Lead",contato:a.contato||"",whatsapp:a.whatsapp||"",email:a.email||"",website:a.website||"",instagram:a.instagram||"",cidade:a.cidade||"",endereco:a.endereco||"",categoria:a.categoria||"",cnpj:a.cnpj||"",aceitaCartao:a.aceitaCartao||""});let c=async e=>{if(a)try{let s={empresa:e.empresa,status:e.status,contato:e.contato||null,telefone_whatsapp:e.whatsapp||null,email:e.email||null,website:e.website||null,instagram:e.instagram||null,cidade:e.cidade||null,endereco:e.endereco||null,categoria:e.categoria||null,cnpj:e.cnpj||null,aceita_cartao:e.aceitaCartao||null,updated_at:new Date().toISOString()},{error:t}=await S.O.from("leads_prospeccao").update(s).eq("id",a.id);if(t)throw t;Z.Am.success("Lead atualizado com sucesso!",{description:"".concat(e.empresa," foi atualizado.")}),d.reset(),n(),o&&o()}catch(e){console.error("Erro ao atualizar lead:",e),Z.Am.error("Erro ao atualizar lead",{description:e instanceof Error?e.message:"Erro desconhecido"})}};if(!a)return null;let m=["Novo Lead","Contato Inicial","Qualifica\xe7\xe3o","Proposta Enviada","Negocia\xe7\xe3o","Fechado Ganho","Fechado Perdido","Em Follow-up"];return(0,t.jsx)(i.Vq,{open:s,onOpenChange:n,children:(0,t.jsxs)(i.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(i.fK,{children:[(0,t.jsxs)(i.$N,{children:["Editar Lead - ",a.lead]}),(0,t.jsxs)(i.Be,{children:["Atualize as informa\xe7\xf5es do lead ",a.empresa]})]}),(0,t.jsx)(x,{...d,children:(0,t.jsxs)("form",{onSubmit:d.handleSubmit(c),className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(h,{control:d.control,name:"empresa",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Empresa *"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"Nome da empresa",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"status",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Status *"}),(0,t.jsxs)(w.Ph,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,t.jsx)(N,{children:(0,t.jsx)(w.i4,{children:(0,t.jsx)(w.ki,{placeholder:"Selecione o status"})})}),(0,t.jsx)(w.Bw,{children:m.map(e=>(0,t.jsx)(w.Ql,{value:e,children:e},e))})]}),(0,t.jsx)(v,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(h,{control:d.control,name:"contato",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Contato Principal"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"Nome do contato",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"whatsapp",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"WhatsApp"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"+55 81 99999-9999",...a})}),(0,t.jsx)(v,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(h,{control:d.control,name:"email",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Email"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{type:"email",placeholder:"email@empresa.com",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"website",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Website"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"https://empresa.com",...a})}),(0,t.jsx)(v,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(h,{control:d.control,name:"instagram",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Instagram"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"@empresa",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"categoria",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Categoria/Nicho"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"Restaurante, Pizzaria, etc.",...a})}),(0,t.jsx)(v,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(h,{control:d.control,name:"cidade",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Cidade"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"S\xe3o Paulo, SP",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"cnpj",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"CNPJ"}),(0,t.jsx)(N,{children:(0,t.jsx)(b.I,{placeholder:"00.000.000/0000-00",...a})}),(0,t.jsx)(v,{})]})}})]}),(0,t.jsx)(h,{control:d.control,name:"endereco",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Endere\xe7o Completo"}),(0,t.jsx)(N,{children:(0,t.jsx)(y.g,{placeholder:"Rua, n\xfamero, bairro, cidade - estado",className:"resize-none",...a})}),(0,t.jsx)(v,{})]})}}),(0,t.jsx)(h,{control:d.control,name:"aceitaCartao",render:e=>{let{field:a}=e;return(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{children:"Aceita Cart\xe3o"}),(0,t.jsxs)(w.Ph,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,t.jsx)(N,{children:(0,t.jsx)(w.i4,{children:(0,t.jsx)(w.ki,{placeholder:"Selecione"})})}),(0,t.jsxs)(w.Bw,{children:[(0,t.jsx)(w.Ql,{value:"Sim",children:"Sim"}),(0,t.jsx)(w.Ql,{value:"N\xe3o",children:"N\xe3o"}),(0,t.jsx)(w.Ql,{value:"N\xe3o informado",children:"N\xe3o informado"})]})]}),(0,t.jsx)(v,{})]})}}),(0,t.jsxs)(i.cN,{className:"gap-2 sm:gap-0",children:[(0,t.jsx)(C.z,{type:"button",variant:"outline",onClick:n,disabled:d.formState.isSubmitting,children:"Cancelar"}),(0,t.jsx)(C.z,{type:"submit",disabled:d.formState.isSubmitting,className:"gradient-primary text-white",children:d.formState.isSubmitting?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):"Salvar Altera\xe7\xf5es"})]})]})})]})})}},15291:function(e,a,s){s.d(a,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return f},i4:function(){return x},ki:function(){return m}});var t=s(57437),r=s(2265),l=s(74797),n=s(40875),i=s(22135),o=s(30401),d=s(93448);let c=l.fC;l.ZA;let m=l.B4,x=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,t.jsxs)(l.xz,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,t.jsx)(l.JO,{asChild:!0,children:(0,t.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.xz.displayName;let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.u_,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});u.displayName=l.u_.displayName;let h=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.$G,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let p=r.forwardRef((e,a)=>{let{className:s,children:r,position:n="popper",...i}=e;return(0,t.jsx)(l.h_,{children:(0,t.jsxs)(l.VY,{ref:a,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,t.jsx)(u,{}),(0,t.jsx)(l.l_,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(h,{})]})})});p.displayName=l.VY.displayName,r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.__,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.__.displayName;let f=r.forwardRef((e,a)=>{let{className:s,children:r,...n}=e;return(0,t.jsxs)(l.ck,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",s),...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.wU,{children:(0,t.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(l.eT,{children:r})]})});f.displayName=l.ck.displayName,r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.Z0,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.Z0.displayName},31593:function(e,a,s){s.d(a,{Z:function(){return i}});var t=s(57437),r=s(2265),l=s(90759),n=s(93448);let i=r.forwardRef((e,a)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...o}=e;return(0,t.jsx)(l.f,{ref:a,decorative:i,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});i.displayName=l.f.displayName},23675:function(e,a,s){s.d(a,{g:function(){return n}});var t=s(57437),r=s(2265),l=s(93448);let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...r})});n.displayName="Textarea"}}]);